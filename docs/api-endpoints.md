# API Endpoints

## GET `/health`

This endpoint is a healthcheck for the main API entrypoint. If successful, you will recieve a `200 OK` response.

---

## POST `/generate`

This endpoint sends a request to the generate service to generate a QR code.

### Request Body
```
{
    "data": "https://www.bbc.co.uk"
}
```

### Responses

`200 OK` - The request was successful and a request was made to the generate service.
```
{
    "id": "gqmsw5qyapmvmowb",
    "message": "QR code requested successfully.",
    "status": 200
}
```

`400 Bad Request` - The request failed due to a missing or invalid `data` key in the request body.
```
{
    "message": "data either not found in body or invalid.",
    "status": 400
}
```
---

## GET `/status/<id>`

This endpoint sends a request to the status service and shows the requested QR code progress. The available states for a QR code are:

| state      | description                                                                |
| ---------- | -------------------------------------------------------------------------- |
| requested  | The QR code was requested and is waiting in the queue                      |
| processing | The QR code is being generated by the generate service                     |
| done       | The QR code has been generated and is not accessible by the fetch endpoint |

### Responses

`200 OK` - The request was successful and the QR code progress was found.
```
{
    "id": "ddvkkp42qx5ynb8f",
    "status": "done"
}
```

`404 Not Found` - The QR code passed into the url does not exist.
```
{
    "message": "QR code not found",
    "status": 404
}
```

---

## GET `/fetch/<id>`

This endpoint fetches a generated QR code and responds with the PNG file.

### Responses

`200 OK` - The QR code was fetched successfully.

`400 Bad Request` - The QR code is still processing and is not in a 'done' state.
```
{
  "message": "QR code is still processing. Please try again later.",
  "status": 400
}
```

`404 Not Found` - The QR code passed into the url does not exist.
```
{
    "message": "QR code not found",
    "status": 404
}
```

`500 Internal Server Error` - Either the file was in a 'done' state and was not found, or an unexpected error occurred.
```
{
  "message": "Internal Server Error",
  "status": 500
}
```

---

[Back to README.md](../README.md)
